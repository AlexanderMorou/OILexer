#include "Expressions.oilexer";

UnaryExpression                          ::=>
    (UnaryOperators:Operators; Whitespace?)*
    PrimaryExpression:Operand;              ;

UnaryOperators                           ::=>
    CastOperator                            |
    UnaryOperator                           ;

UnaryOperator                             ::=
    (
        '+'                                 |
        '-'                                 |
        '!'                                 |
        '~'                                 |
        "++"                                |
        "--"
    ):Operator;                             ;
    
CastOperator                              ::=
    '('
        WhitePaddingOpt<Type:Operator;> 
    ')'                                     ;

MultiplicitiveExpression                  ::=
    BinaryOperationExpression<
        MultiplicitiveExpression,
        ('/' | '*' | '%'):Operator;,
        UnaryExpression,
        PrecedenceAssociation.Left>         ;

AdditiveExpression                        ::=
    BinaryOperationExpression<
        AdditiveExpression,
        ('+' | '-'):Operator;,
        MultiplicitiveExpression,
        PrecedenceAssociation.Left>         ;

ShiftExpression                           ::=
    BinaryOperationExpression<
        ShiftExpression,
        ("<<" | ">>"):Operator;,
        AdditiveExpression,
        PrecedenceAssociation.Left>         ;

RelationalExpression                     ::=>
    TypeRelationalExpression                |
    ValueRelationalExpression               ;

ValueRelationalExpression                 ::=
    BinaryOperationExpression<
        RelationalExpression,
        ('<' | '>' | "<=" | ">="):Operator;,
        ShiftExpression,
        PrecedenceAssociation.Left>         ;

TypeRelationalExpression                  ::=
    RelationalExpression:Left;
    WhitePaddingOpt<(
        "is"                                |
        "as"
    ):Operator;>
    Type:Right;                             ;

EqualityExpression                        ::=
    BinaryOperationExpression<
        EqualityExpression,
        ("==" | "!="):Operator;,
        RelationalExpression,
        PrecedenceAssociation.Left>         ;

AndExpression                             ::=
    BinaryOperationExpression<
        AndExpression,
        '&',
        EqualityExpression,
        PrecedenceAssociation.Left>         ;

ExclusiveOrExpression                     ::=
    BinaryOperationExpression<
        ExclusiveOrExpression,
        '^',
        AndExpression,
        PrecedenceAssociation.Left>         ;

InclusiveOrExpression                     ::=
    BinaryOperationExpression<
        InclusiveOrExpression,
        '|',
        ExclusiveOrExpression,
        PrecedenceAssociation.Left>         ;

ConditionalAndExpression                  ::=
    BinaryOperationExpression<
        ConditionalAndExpression,
        "&&",
        InclusiveOrExpression,
        PrecedenceAssociation.Left>         ;

ConditionalOrExpression                   ::=
    BinaryOperationExpression<
        ConditionalOrExpression,
        "||",
        ConditionalAndExpression,
        PrecedenceAssociation.Left>         ;

NullCoalescingExpression                  ::=
    BinaryOperationExpression<
        NullCoalescingExpression,
        "??",
        ConditionalOrExpression,
        PrecedenceAssociation.Right>        ;

ConditionalExpression                     ::=
    NullCoalescingExpression:Term;
    (
        WhitePaddingOpt<'?'>
        Expression:TruePart; 
        WhitePaddingOpt<':'>
        Expression:FalsePart;
    )?                                      ;

AssignmentExpression                      ::=
    BinaryOperationExpression<
        Expression,
        (
            '='                             | 
            "+="                            | 
            "-="                            | 
            "*="                            | 
            "/="                            | 
            "%="                            | 
            "&="                            | 
            "|="                            | 
            "^="                            | 
            "<<="                           | 
            ">>="
        ):Operator;,
        UnaryExpression,
        PrecedenceAssociation.Right>        ;

NonAssignmentExpression                  ::=>
    ConditionalExpression                   |
    LambdaExpression                        |
    QueryExpression                         ;

CrementExpression                        ::=>
    PrecrementExpression                    |
    PostcrementExpression                   ;

PrecrementExpression                      ::=
    ("++" | "--"):Operator; Whitespace?
    UnaryExpression:Term;                   ;

PostcrementExpression                     ::=
    PrimaryExpression:Term; Whitespace?
    ("++" | "--"):Operator;                 ;